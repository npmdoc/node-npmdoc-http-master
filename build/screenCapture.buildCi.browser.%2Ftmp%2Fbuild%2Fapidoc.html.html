<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/encharm/http-master#readme">http-master (v1.2.6)</a>
</h1>
<h4>Easy to setup, convenient, universal, parallel, http/https proxy daemon. Setup in 1 minute, run, configure, adapt. Proxying based on excellent node-http-proxy.</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master">module http-master</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.http-master">
            function <span class="apidocSignatureSpan"></span>http-master
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.CertScanner">
            function <span class="apidocSignatureSpan">http-master.</span>CertScanner
            <span class="apidocSignatureSpan">(sslDirectory, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable">
            function <span class="apidocSignatureSpan">http-master.</span>DispatchTable
            <span class="apidocSignatureSpan">(port, params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker">
            function <span class="apidocSignatureSpan">http-master.</span>HttpMasterWorker
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di">
            function <span class="apidocSignatureSpan">http-master.</span>di
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.regexpHelper">
            function <span class="apidocSignatureSpan">http-master.</span>regexpHelper
            <span class="apidocSignatureSpan">(href, match)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">http-master.</span>DispatchTable.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">http-master.</span>HttpMasterWorker.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">http-master.</span>di.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">http-master.</span>testUtils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.DispatchTable">module http-master.DispatchTable</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable.DispatchTable">
            function <span class="apidocSignatureSpan">http-master.</span>DispatchTable
            <span class="apidocSignatureSpan">(port, params)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable.regexpQuote">
            function <span class="apidocSignatureSpan">http-master.DispatchTable.</span>regexpQuote
            <span class="apidocSignatureSpan">(str, delimiter)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.DispatchTable.prototype">module http-master.DispatchTable.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable.prototype.checkPathForReq">
            function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>checkPathForReq
            <span class="apidocSignatureSpan">(req, entry)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable.prototype.dispatchRequest">
            function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>dispatchRequest
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable.prototype.getTargetForReq">
            function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>getTargetForReq
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.DispatchTable.prototype.handleRequest">
            function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>handleRequest
            <span class="apidocSignatureSpan">(req, res, next)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.HttpMasterWorker">module http-master.HttpMasterWorker</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker.HttpMasterWorker">
            function <span class="apidocSignatureSpan">http-master.</span>HttpMasterWorker
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.HttpMasterWorker.prototype">module http-master.HttpMasterWorker.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker.prototype.gcServers">
            function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>gcServers
            <span class="apidocSignatureSpan">(gcFinished)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker.prototype.loadConfig">
            function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>loadConfig
            <span class="apidocSignatureSpan">(config, configLoaded)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker.prototype.logError">
            function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>logError
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker.prototype.logNotice">
            function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>logNotice
            <span class="apidocSignatureSpan">(msg)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.HttpMasterWorker.prototype.unbindAll">
            function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>unbindAll
            <span class="apidocSignatureSpan">(unbindFinished)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.di">module http-master.di</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.di">
            function <span class="apidocSignatureSpan">http-master.</span>di
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.di.prototype">module http-master.di.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.bindInstance">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindInstance
            <span class="apidocSignatureSpan">(name, instance)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.bindResolver">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindResolver
            <span class="apidocSignatureSpan">(name, resolver)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.bindTransientType">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindTransientType
            <span class="apidocSignatureSpan">(name, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.bindType">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindType
            <span class="apidocSignatureSpan">(name, type)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.clone">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>clone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.makeChild">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>makeChild
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.di.prototype.resolve">
            function <span class="apidocSignatureSpan">http-master.di.prototype.</span>resolve
            <span class="apidocSignatureSpan">(obj, overrides)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.http-master.testUtils">module http-master.testUtils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.testUtils.assurePortIsListening">
            function <span class="apidocSignatureSpan">http-master.testUtils.</span>assurePortIsListening
            <span class="apidocSignatureSpan">(port, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.testUtils.assurePortNotListening">
            function <span class="apidocSignatureSpan">http-master.testUtils.</span>assurePortNotListening
            <span class="apidocSignatureSpan">(port, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.testUtils.findPort">
            function <span class="apidocSignatureSpan">http-master.testUtils.</span>findPort
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.http-master.testUtils.findPorts">
            function <span class="apidocSignatureSpan">http-master.testUtils.</span>findPorts
            <span class="apidocSignatureSpan">(num, cb)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master" id="apidoc.module.http-master">module http-master</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.http-master" id="apidoc.element.http-master.http-master">
        function <span class="apidocSignatureSpan"></span>http-master
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HttpMaster() {
  var workers = this.workers = [];
  this.tlsSessionStore = {};

  // hacky way to ensure that our cluster is a locally loaded one
  // use this until https://github.com/joyent/node/pull/3367 is merged
  var oldCluster = require.cache[require.resolve('cluster')];
  delete require.cache[require.resolve('cluster')];
  var cluster = this.cluster = require('cluster');
  require.cache[require.resolve('cluster')] = oldCluster;

  this.cluster.setupMaster({
    exec: path.join(__dirname, 'worker.js'),
    args: []
  });

  this.autoRestartWorkers = true;

  var self = this;
  cluster.on('exit', function(worker, code, signal) {
    if (!self.autoRestartWorkers) {
      return;
    }
    self.logError("Worker " + worker.id + " failed with code " + code + "/" + signal + " ... starting replacement");
    workers[worker.id - 1] = undefined;
    var newWorker = initWorker.call(self, function() {
      self.logNotice("Worker " + newWorker.id + " started in place of worker " + worker.id);
      workers[newWorker.id - 1] = newWorker;
    });
  });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.CertScanner" id="apidoc.element.http-master.CertScanner">
        function <span class="apidocSignatureSpan">http-master.</span>CertScanner
        <span class="apidocSignatureSpan">(sslDirectory, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">class CertScanner extends EventEmitter {
  constructor(sslDirectory, options) {
    super();

    this.options = options;

    options = options || {};

    if(!sslDirectory) {
      throw new Error('sslDirectory as first argument is mandatory');
    }

    this.sslDirectory = sslDirectory;
    if (!sslDirectory.match(/\/$/)) {
      this.sslDirectory += '/';
    }

    this.readPart = async.memoize(function(file, maxRead, cb) {
      fs.open(file, 'r', function(err, fd) {
        if(err) return cb(err);
        var buf = new Buffer(maxRead);
        fs.read(fd, buf, 0, maxRead, null, function(err, bytesRead, buffer) {
          fs.close(fd);
          if(bytesRead &lt; maxRead)
            return cb(err, buffer.slice(0, bytesRead).toString('utf8'));
          return cb(err, buffer.toString('utf8'));
        });
      });
    });

    var beginCertToken = '-----BEGIN CERTIFICATE-----';
    var endCertToken = '-----END CERTIFICATE-----';
    this.getCaCertsFromFile = function(certPath, cb) {
      // TODO: This can possibly be replaced with some regexp.
      this.readPart(certPath, 4*65536, function(err, certFileContent) {
        if(err) return cb(err);

        var possibleCerts = certFileContent.split(beginCertToken);
        var certs = [];
        var rawCerts = [];
        possibleCerts.forEach(function(cert) {
          var endTokenIndex = cert.indexOf(endCertToken);
          if (endTokenIndex === -1) {
            return null;
          }
          var rawCert = cert.substring(0, endTokenIndex);
          var parsedCert = beginCertToken + rawCert + endCertToken + '\n';
          try {
            certs.push(x509.parseCert(parsedCert));
            rawCerts.push(parsedCert);
          } catch(err) {

          }
        });
        cb(null, certs, rawCerts);
      });
    };

    this.getCaFor = async.memoize((certPath, cb) =&gt; {
      this.readPart(certPath, 65636, (err, rawCert) =&gt; {
        if(err) return cb(err);

        var parsedCert;
        try {
          parsedCert = x509.parseCert(rawCert);
        } catch(err) {
          return cb(err);
        }
        var caResults = [];
        var caRawResults = [];
        let processDirectory = (dirName, cb) =&gt; {
          fs.readdir(dirName, (err, files) =&gt; {

            if(err) return cb(err);

            async.filter(files, (certFile, cb) =&gt; {
              var certPath = path.join(dirName, certFile);

              fs.stat(certPath, (err, statData) =&gt; {
                if(statData.isDirectory()) {
                  return processDirectory(certPath, () =&gt; {
                    cb(null, false); // is a directory
                  });
                }

                this.getCaCertsFromFile(certPath, (err, certs, rawCerts) =&gt; {
                  if(err) return cb(null, false);

                  if (this.isDomainCert(certs)) {
                    return cb(null, false);
                  }
                  var matchingCa = certs.filter((cert, i) =&gt; {
                    var res = this.caMatches(cert, parsedCert);

                    if(res) {
                      caRawResults.push(rawCerts[i]);
                    }
                    return res;
                  });
                  return cb(null, matchingCa.length);
                });
              });
            }, function(err, ca) {
              caResults = ca.map(fileName =&gt; {
                return path.join(dirName, fileName);
              }).concat(caResults);

              cb(null);
            });
          });
        }
        processDirectory(this.sslDirectory, err =&gt; {
          if(err) return cb(err);

          function noArrayIfOne(arr) {
            return (arr.length === 1) ? arr[0] : arr;
          }

          if(caResults.length) {
            cb(null, noArrayIfOne(caResults), noArrayIfOne(caRawResults));
          }
          else {
            cb(null);
          }
        });
      });
    });
  }

  scan(cb) {
    var outputConfig = {};

    var keys = {};
    var certs = {};

    let options = this.options;

    let processDirectory = (dirName, cb) =&gt; { ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.DispatchTable" id="apidoc.element.http-master.DispatchTable">
        function <span class="apidocSignatureSpan">http-master.</span>DispatchTable
        <span class="apidocSignatureSpan">(port, params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DispatchTable(port, params) {
  var parseEntry = params.entryParser;
  var config = params.config;

  var self = this;
  this.requestHandler = params.requestHandler;
  this.upgradeHandler = params.upgradeHandler;
  this.table = {};
  this.regexpEntries = [];
  this.failedEntries = {};
  Object.keys(config || {}).forEach(function(entryKey) {
    var entry = config[entryKey];


    // split entry 192.168.0.0/host to
    // ['192.168.0.0', '/']
    var entryKeyData = splitFirst(entryKey);
    entryKey = entryKeyData[0];
    var entryPath = entryKeyData[1];

    if(entryPath) {
      entryPath = decodeURIComponent(entryPath);
    }
    if (parseEntry) {
      var parsedEntry = parseEntry(entry);
      assert(typeof parsedEntry !== 'undefined', 'entryParser should have returned something');
      entry = parsedEntry;
    }
    entry = {
      target: entry,
      port: port
    };
    if (entryPath) {
      entry.path = entryPath;
      var pathRegexp = getRegexpIfNeeded(entryPath, '\/');
      if (pathRegexp)
        entry.pathRegexp = pathRegexp;
    }
    entryKey = postParseKey(entryKey, entry);
    port = port || 80;

    if (entry.regexp) {
      self.regexpEntries.push(entry);
    } else {
      if (self.table[entryKey]) {
        if (self.table[entryKey] instanceof Array) {
          self.table[entryKey].push(entry);
          self.table[entryKey + ':' + port].push(entry);
        } else {
          var oldEntry = self.table[entryKey];
          self.table[entryKey] = [oldEntry, entry];
          self.table[entryKey + ':' + port] = [oldEntry, entry];
        }
      } else {
        self.table[entryKey + ':' + port] = entry;
        self.table[entryKey] = entry;
      }
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker" id="apidoc.element.http-master.HttpMasterWorker">
        function <span class="apidocSignatureSpan">http-master.</span>HttpMasterWorker
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HttpMasterWorker(config) {
  config = config || {};
  this.config = config;
  this.middleware = [];
  var store = {};
  this.tlsSessionStore = config.tlsSessionStore || {
    get: function(id, cb) {
      id = id.toString('base64');
      cb(null, store[id], null);
    },
    set: function(id, data, cb) {
      id = id.toString('base64');
      store[id] = data;
      // todo cleanup old ids
      if (cb)
        cb();
    }
  };
  this.tcpServers = {};
  this.servers = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di" id="apidoc.element.http-master.di">
        function <span class="apidocSignatureSpan">http-master.</span>di
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DI() {
  this.mapping = {};
  this.parent = null;
  this.onMissing = function(name) {
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.regexpHelper" id="apidoc.element.http-master.regexpHelper">
        function <span class="apidocSignatureSpan">http-master.</span>regexpHelper
        <span class="apidocSignatureSpan">(href, match)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">regexpHelper = function (href, match) {
  var pathMatchOffset = 0;
  return processMatch(href, match);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>










</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.DispatchTable" id="apidoc.module.http-master.DispatchTable">module http-master.DispatchTable</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.DispatchTable.DispatchTable" id="apidoc.element.http-master.DispatchTable.DispatchTable">
        function <span class="apidocSignatureSpan">http-master.</span>DispatchTable
        <span class="apidocSignatureSpan">(port, params)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DispatchTable(port, params) {
  var parseEntry = params.entryParser;
  var config = params.config;

  var self = this;
  this.requestHandler = params.requestHandler;
  this.upgradeHandler = params.upgradeHandler;
  this.table = {};
  this.regexpEntries = [];
  this.failedEntries = {};
  Object.keys(config || {}).forEach(function(entryKey) {
    var entry = config[entryKey];


    // split entry 192.168.0.0/host to
    // ['192.168.0.0', '/']
    var entryKeyData = splitFirst(entryKey);
    entryKey = entryKeyData[0];
    var entryPath = entryKeyData[1];

    if(entryPath) {
      entryPath = decodeURIComponent(entryPath);
    }
    if (parseEntry) {
      var parsedEntry = parseEntry(entry);
      assert(typeof parsedEntry !== 'undefined', 'entryParser should have returned something');
      entry = parsedEntry;
    }
    entry = {
      target: entry,
      port: port
    };
    if (entryPath) {
      entry.path = entryPath;
      var pathRegexp = getRegexpIfNeeded(entryPath, '\/');
      if (pathRegexp)
        entry.pathRegexp = pathRegexp;
    }
    entryKey = postParseKey(entryKey, entry);
    port = port || 80;

    if (entry.regexp) {
      self.regexpEntries.push(entry);
    } else {
      if (self.table[entryKey]) {
        if (self.table[entryKey] instanceof Array) {
          self.table[entryKey].push(entry);
          self.table[entryKey + ':' + port].push(entry);
        } else {
          var oldEntry = self.table[entryKey];
          self.table[entryKey] = [oldEntry, entry];
          self.table[entryKey + ':' + port] = [oldEntry, entry];
        }
      } else {
        self.table[entryKey + ':' + port] = entry;
        self.table[entryKey] = entry;
      }
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.DispatchTable.regexpQuote" id="apidoc.element.http-master.DispatchTable.regexpQuote">
        function <span class="apidocSignatureSpan">http-master.DispatchTable.</span>regexpQuote
        <span class="apidocSignatureSpan">(str, delimiter)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function regexpQuote(str, delimiter) {
  // http://kevin.vanzonneveld.net
  // +   original by: booeyOH
  // +   improved by: Ates Goral (http://magnetiq.com)
  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  // +   bugfixed by: Onno Marsman
  // +   improved by: Brett Zamir (http://brett-zamir.me)
  // *     example 1: preg_quote("$40");
  // *     returns 1: '\$40'
  // *     example 2: preg_quote("*RRRING* Hello?");
  // *     returns 2: '\*RRRING\* Hello\?'
  // *     example 3: preg_quote("\\.+*?[^]$(){}=!&lt;&gt;|:");
  // *     returns 3: '\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\&lt;\&gt;\|\:'
  return (str + '').replace(new RegExp('[.\\\\+*?\\[\\^\\]$(){}=!&lt;&gt;|:\\' + (delimiter || '') + '-]', 'g'), '\\$&amp;');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.DispatchTable.prototype" id="apidoc.module.http-master.DispatchTable.prototype">module http-master.DispatchTable.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.DispatchTable.prototype.checkPathForReq" id="apidoc.element.http-master.DispatchTable.prototype.checkPathForReq">
        function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>checkPathForReq
        <span class="apidocSignatureSpan">(req, entry)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">checkPathForReq = function (req, entry) {
  if(!entry.path)
    return true;
  var m;

  var parsedUrl = req.parsedUrl;
  var pathname = parsedUrl.pathname || '';

  try {
    pathname = decodeURIComponent(pathname);
  } catch(err) {}

  if(entry.pathRegexp) {
    m = pathname.match(entry.pathRegexp);
    if (m) {
      if(!req.match)
        req.match = [];
      for(var i = 1;i &lt; m.length;++i) {
        req.match.push(m[i]);
      }
      return true;
    }
  }
  else if(pathname == entry.path) {
    return true;
  }
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

// look for specific host match first
// and generic path-only match then
[host, ''].some(function(host) {
  var entry = self.table[host];
  if (entry) {
    if (entry.target) {
      if(self.<span class="apidocCodeKeywordSpan">checkPathForReq</span>(req, entry)) {
        target = entry.target
        return true;
      }
    }
    else { // multiple entries, check pathnames
      var targetEntries = entry;
      for (i = 0; i &lt; targetEntries.length; ++i) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.DispatchTable.prototype.dispatchRequest" id="apidoc.element.http-master.DispatchTable.prototype.dispatchRequest">
        function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>dispatchRequest
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dispatchRequest = function (req, res, next) {
  var target = this.getTargetForReq(req);
  if(target &amp;&amp; this.requestHandler) {
    return this.requestHandler(req, res, next, target);
  }
  next();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.DispatchTable.prototype.getTargetForReq" id="apidoc.element.http-master.DispatchTable.prototype.getTargetForReq">
        function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>getTargetForReq
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getTargetForReq = function (req) {
  var i, m;
  var host = req.unicodeHost || req.headers.host || ''; // host can be undefined

  var self = this;
  var target;

  // look for specific host match first
  // and generic path-only match then
  [host, ''].some(function(host) {
    var entry = self.table[host];
    if (entry) {
      if (entry.target) {
        if(self.checkPathForReq(req, entry)) {
          target = entry.target
          return true;
        }
      }
      else { // multiple entries, check pathnames
        var targetEntries = entry;
        for (i = 0; i &lt; targetEntries.length; ++i) {
          if(self.checkPathForReq(req, targetEntries[i])) {
            target = targetEntries[i].target;
            return true;
          }
        }
      }
    }
  });
  if(target) {
    return target;
  }
  // if host-only matches failed, look for path matches
  if (this.regexpEntries.length) {
    var regexpEntries = this.regexpEntries;
    for (i = 0; i &lt; regexpEntries.length; ++i) {
      var entry = regexpEntries[i];
      if(!entry.regexp) {
        // TODO: research this
        continue;
      }
      m = host.match(entry.regexp);
      if (m) {
        if(!req.match)
          req.match = [];
        for(var i = 1;i &lt; m.length;++i)
          req.match.push(m[i]);
        if(this.checkPathForReq(req, entry)) {
          return entry.target;
        }
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
      }
    }
  }
};

DispatchTable.prototype.dispatchRequest = function(req, res, next) {
  var target = this.<span class="apidocCodeKeywordSpan">getTargetForReq</span>(req);
  if(target &amp;&amp; this.requestHandler) {
    return this.requestHandler(req, res, next, target);
  }
  next();
};

DispatchTable.prototype.handleRequest = DispatchTable.prototype.dispatchRequest;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.DispatchTable.prototype.handleRequest" id="apidoc.element.http-master.DispatchTable.prototype.handleRequest">
        function <span class="apidocSignatureSpan">http-master.DispatchTable.prototype.</span>handleRequest
        <span class="apidocSignatureSpan">(req, res, next)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handleRequest = function (req, res, next) {
  var target = this.getTargetForReq(req);
  if(target &amp;&amp; this.requestHandler) {
    return this.requestHandler(req, res, next, target);
  }
  next();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.HttpMasterWorker" id="apidoc.module.http-master.HttpMasterWorker">module http-master.HttpMasterWorker</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker.HttpMasterWorker" id="apidoc.element.http-master.HttpMasterWorker.HttpMasterWorker">
        function <span class="apidocSignatureSpan">http-master.</span>HttpMasterWorker
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HttpMasterWorker(config) {
  config = config || {};
  this.config = config;
  this.middleware = [];
  var store = {};
  this.tlsSessionStore = config.tlsSessionStore || {
    get: function(id, cb) {
      id = id.toString('base64');
      cb(null, store[id], null);
    },
    set: function(id, data, cb) {
      id = id.toString('base64');
      store[id] = data;
      // todo cleanup old ids
      if (cb)
        cb();
    }
  };
  this.tcpServers = {};
  this.servers = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.HttpMasterWorker.prototype" id="apidoc.module.http-master.HttpMasterWorker.prototype">module http-master.HttpMasterWorker.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker.prototype.gcServers" id="apidoc.element.http-master.HttpMasterWorker.prototype.gcServers">
        function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>gcServers
        <span class="apidocSignatureSpan">(gcFinished)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">gcServers = function (gcFinished) {
  var self = this;
  var toClose = [];

  Object.keys(this.tcpServers).forEach(function(key) {
    var server = self.tcpServers[key];
    if (require('events').EventEmitter.listenerCount(server, 'connection') === 0) {
      toClose.push(server);
      delete self.tcpServers[key];
      if (self.cachedServers[key]) {
        self.cachedServers[key].server.removeAllListeners();
        delete self.cachedServers[key];
      }
    }
  });
  async.each(toClose, function(server, cb) {
    server.close();
    cb();
  }, gcFinished);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      di.resolve(require(path.join(__dirname, '..', 'modules', moduleName)));
    } catch (err) {
      console.error("Error loading module:", moduleName, err);
    }
  });

  handleConfig.call(this, config, function(err) {
    self.<span class="apidocCodeKeywordSpan">gcServers</span>(function() {
      if (configLoaded)
        configLoaded(err);
    });
  });
};

HttpMasterWorker.prototype.gcServers = function(gcFinished) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker.prototype.loadConfig" id="apidoc.element.http-master.HttpMasterWorker.prototype.loadConfig">
        function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>loadConfig
        <span class="apidocSignatureSpan">(config, configLoaded)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">loadConfig = function (config, configLoaded) {
  var self = this;

  var events = new EventEmitter();

  this.config = config;

  function messageHandler(msg) {
    events.emit('msg:' + msg.type, msg.data, msg.workerId);
  }
  this.handleMessage = messageHandler;

  this.unbindAll(function() {});
  if (this.di) {
    this.emit('reload');
  }
  var di = this.di = new DI();

  di.onMissing = function(name) {
    var m;
    if ((m = name.match(/(.+)Service$/))) {
      name = m[1];
      try {
        this.bindType(name + 'Service', require(path.join(__dirname, '..', 'modules/services/', name)));
      } catch (err) {
        console.log(err &amp;&amp; err.message);
        return;
      }
      self.emit('loadService', name);
      return this.resolve(name + 'Service');
    }
  };

  di.bindInstance('di', di);
  di.bindInstance('worker', this);

  this.once('reload', function() {
    process.removeListener('msg', messageHandler);
    events.emit('reload');
    events.removeAllListeners();
  });

  di.bindInstance('events', events);
  di.bindResolver('config', function() {
    return self.config;
  });
  di.bindInstance('master', null);
  Object.keys(config.modules || {}).forEach(function(moduleName) {
    if (!config.modules[moduleName])
      return;
    var di = self.di.makeChild();
    di.bindInstance('di', di);
    di.bindInstance('moduleConfig', config.modules[moduleName]);
    try {
      di.resolve(require(path.join(__dirname, '..', 'modules', moduleName)));
    } catch (err) {
      console.error("Error loading module:", moduleName, err);
    }
  });

  handleConfig.call(this, config, function(err) {
    self.gcServers(function() {
      if (configLoaded)
        configLoaded(err);
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker.prototype.logError" id="apidoc.element.http-master.HttpMasterWorker.prototype.logError">
        function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>logError
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">logError = function (msg) {
  this.emit('logError', msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var listenPortNumber = parseInt(m[3]);

var portConfig = config.ports[portEntry];

handlePortEntryConfig.call(self, listenHost, listenPortNumber, portConfig, function(err, server) {
  var entryString = (listenHost ? listenHost + ':' + listenPortNumber : 'port ' + listenPortNumber);
  if (err) {
    self.<span class="apidocCodeKeywordSpan">logError</span>('Error while starting entry ' + entryString + ' : &amp;#
x27; + err.toString());
    if (err.stack)
      self.logError(err.stack);
    errors[portEntry] = err;
  }
  if (server) {
    self.logNotice('Listening on port: ' + entryString);
  } else
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker.prototype.logNotice" id="apidoc.element.http-master.HttpMasterWorker.prototype.logNotice">
        function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>logNotice
        <span class="apidocSignatureSpan">(msg)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">logNotice = function (msg) {
  this.emit('logNotice', msg);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    if (!portEntrySslConfig.ciphers) {
      portEntrySslConfig.ciphers = 'EECDH+ECDSA+AESGCM:EECDH+aRSA+AESGCM:EECDH+ECDSA+SHA384:EECDH+ECDSA+SHA256:EECDH+aRSA+SHA384
:EECDH+aRSA+SHA256:EECDH+aRSA+AES+SHA:EECDH+aRSA+RC4:EECDH:EDH+aRSA:RC4:!aNULL:!eNULL:!LOW:!3DES:!MD5:!EXP:!PSK:!SRP:!DSS::+RC4:
RC4';
      if (portEntrySslConfig.disableWeakCiphers) {
        portEntrySslConfig.ciphers += ':!RC4';
      }
    } else if (portEntrySslConfig.disableWeakCiphers) {
      this.<span class="apidocCodeKeywordSpan">logNotice</span>('disableWeakCiphers is incompatible with pre-set cipher list
');
    }
  } else if (portEntrySslConfig.disableWeakCiphers) {
    this.logNotice('disableWeakCiphers is unsupported for node 0.10');
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.HttpMasterWorker.prototype.unbindAll" id="apidoc.element.http-master.HttpMasterWorker.prototype.unbindAll">
        function <span class="apidocSignatureSpan">http-master.HttpMasterWorker.prototype.</span>unbindAll
        <span class="apidocSignatureSpan">(unbindFinished)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">unbindAll = function (unbindFinished) {
  unbindAll.call(this, unbindFinished);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.config = config;

function messageHandler(msg) {
  events.emit('msg:' + msg.type, msg.data, msg.workerId);
}
this.handleMessage = messageHandler;

this.<span class="apidocCodeKeywordSpan">unbindAll</span>(function() {});
if (this.di) {
  this.emit('reload');
}
var di = this.di = new DI();

di.onMissing = function(name) {
  var m;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.di" id="apidoc.module.http-master.di">module http-master.di</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.di.di" id="apidoc.element.http-master.di.di">
        function <span class="apidocSignatureSpan">http-master.</span>di
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function DI() {
  this.mapping = {};
  this.parent = null;
  this.onMissing = function(name) {
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.di.prototype" id="apidoc.module.http-master.di.prototype">module http-master.di.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.di.prototype.bindInstance" id="apidoc.element.http-master.di.prototype.bindInstance">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindInstance
        <span class="apidocSignatureSpan">(name, instance)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindInstance = function (name, instance) {
  if(this.mapping[name]) {
    throw new Error('\'' + name + '\' already bound');
  }
  this.mapping[name] = {
    resolve: function() {
      return instance;
    }
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...



function createHandlers(portNumber, portConfig) {
  var self = this;

  var di = this.di.makeChild();
  di.<span class="apidocCodeKeywordSpan">bindInstance</span>('di', di);

  di.bindInstance('portConfig', portConfig);
  di.bindInstance('portNumber', portNumber);

  di.onMissing = function(name) {

var m;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di.prototype.bindResolver" id="apidoc.element.http-master.di.prototype.bindResolver">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindResolver
        <span class="apidocSignatureSpan">(name, resolver)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindResolver = function (name, resolver) {
  if(this.mapping[name]) {
    throw new Error('\'' + name + '\' already bound');
  }
  this.mapping[name] = {
    resolve: resolver
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.once('reload', function() {
  process.removeListener('msg', messageHandler);
  events.emit('reload');
  events.removeAllListeners();
});

di.bindInstance('events', events);
di.<span class="apidocCodeKeywordSpan">bindResolver</span>('config', function() {
  return self.config;
});
di.bindInstance('master', null);
Object.keys(config.modules || {}).forEach(function(moduleName) {
  if (!config.modules[moduleName])
    return;
  var di = self.di.makeChild();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di.prototype.bindTransientType" id="apidoc.element.http-master.di.prototype.bindTransientType">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindTransientType
        <span class="apidocSignatureSpan">(name, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindTransientType = function (name, type) {
  return bindTypeGeneric.call(this, false, name, type);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di.prototype.bindType" id="apidoc.element.http-master.di.prototype.bindType">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>bindType
        <span class="apidocSignatureSpan">(name, type)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindType = function (name, type) {
  return bindTypeGeneric.call(this, true, name, type);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

di.onMissing = function(name) {

  var m;
  if ((m = name.match(/(.+)Middleware$/))) {
    name = m[1];
    try {
      di.<span class="apidocCodeKeywordSpan">bindType</span>(name + 'Middleware', require('../' + path.join(&amp;#
x27;modules/middleware/', name)));
    } catch (err) {
      console.log(err &amp;&amp; err.message);
      return;
    }
    return di.resolve(name + 'Middleware');
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di.prototype.clone" id="apidoc.element.http-master.di.prototype.clone">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>clone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clone = function () {
  var cloned = new DI();
  cloned.mapping = extend({}, this.mapping);
  cloned.parent = this.parent;
  cloned.onMissing = this.onMissing;
  return cloned;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di.prototype.makeChild" id="apidoc.element.http-master.di.prototype.makeChild">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>makeChild
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">makeChild = function () {
  var child = construct(DI, Array.prototype.slice.apply(arguments));
  child.parent = this;
  return child;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}



function createHandlers(portNumber, portConfig) {
var self = this;

var di = this.di.<span class="apidocCodeKeywordSpan">makeChild</span>();
di.bindInstance('di', di);

di.bindInstance('portConfig', portConfig);
di.bindInstance('portNumber', portNumber);

di.onMissing = function(name) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.di.prototype.resolve" id="apidoc.element.http-master.di.prototype.resolve">
        function <span class="apidocSignatureSpan">http-master.di.prototype.</span>resolve
        <span class="apidocSignatureSpan">(obj, overrides)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">resolve = function (obj, overrides) {
  var dependencyMap = extend({}, this.mapping, overrides);
  var args;
  var resolved;

  if(typeof obj === 'function') {
    args = functionParameters(obj);
    resolved = construct(obj, args.map(this.resolve.bind(this)));
  } else if(typeof obj === 'string') {
    if(dependencyMap[obj]) {
      if(dependencyMap[obj].resolve) {
        resolved = dependencyMap[obj].resolve(overrides);
      } else {
        resolved = dependencyMap[obj];
      }
    }
  } else {
    throw new Error('Unknown type to resolve');
  }

  if(typeof resolved ==='undefined' &amp;&amp; this.onMissing) {
    resolved = this.onMissing(obj);
  }

  if(typeof resolved === 'undefined' &amp;&amp; this.parent) { // search in parent if not found
    resolved = this.parent.resolve(obj, overrides);
  }

  if(typeof resolved === 'undefined' &amp;&amp; !dependencyMap[obj]) {
    throw new Error('No recipe to resolve \'' + obj + '\'');
  }

  return resolved;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    name = m[1];
    try {
      di.bindType(name + 'Middleware', require('../' + path.join('modules/middleware/', name)));
    } catch (err) {
      console.log(err &amp;&amp; err.message);
      return;
    }
    return di.<span class="apidocCodeKeywordSpan">resolve</span>(name + 'Middleware');
  }
};

var router = di.resolve('routerMiddleware');

// allow also for specifying 80: 'http://code2flow.com:8080'
if (typeof portConfig !== 'object' || portConfig instanceof Array) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.http-master.testUtils" id="apidoc.module.http-master.testUtils">module http-master.testUtils</a></h1>


    <h2>
        <a href="#apidoc.element.http-master.testUtils.assurePortIsListening" id="apidoc.element.http-master.testUtils.assurePortIsListening">
        function <span class="apidocSignatureSpan">http-master.testUtils.</span>assurePortIsListening
        <span class="apidocSignatureSpan">(port, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">assurePortIsListening = function (port, cb) {
  var client = net.connect({
      port: port
    },
    function() {
      cb();
    });
  client.once('error', function(err) {
    throw new Error('Port ' + port + ' should have been listening');
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.testUtils.assurePortNotListening" id="apidoc.element.http-master.testUtils.assurePortNotListening">
        function <span class="apidocSignatureSpan">http-master.testUtils.</span>assurePortNotListening
        <span class="apidocSignatureSpan">(port, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">assurePortNotListening = function (port, cb) {
  var client = net.connect({
      port: port
    },
    function() {
      throw new Error('Port ' + port + ' should have been not listening');
    });
  client.once('error', function(err) {
    cb();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.testUtils.findPort" id="apidoc.element.http-master.testUtils.findPort">
        function <span class="apidocSignatureSpan">http-master.testUtils.</span>findPort
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findPort = function (fn) {
  var net = require('net')
  var tester = net.createServer();
  var port;
  tester.once('error', function (err) {
    if (err.code !== 'EADDRINUSE') return fn(err)
    exports.findPort(fn);
  })
  .once('listening', function() {
    port = tester.address().port;
    tester.once('close', function() {
      fn(null, port);
    })
    tester.close();
  })
  .listen(0);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

exports.findPort = function(fn) {
var net = require('net')
var tester = net.createServer();
var port;
tester.once('error', function (err) {
  if (err.code !== 'EADDRINUSE') return fn(err)
  exports.<span class="apidocCodeKeywordSpan">findPort</span>(fn);
})
.once('listening', function() {
  port = tester.address().port;
  tester.once('close', function() {
    fn(null, port);
  })
  tester.close();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.http-master.testUtils.findPorts" id="apidoc.element.http-master.testUtils.findPorts">
        function <span class="apidocSignatureSpan">http-master.testUtils.</span>findPorts
        <span class="apidocSignatureSpan">(num, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findPorts = function (num, cb) {
  async.times(num, function(n, cb) {
    exports.findPort(cb);
  }, function(err, port) {
    cb(err, port);
  }, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>